# Can't restore the flag? (207pt Hard)
# å•é¡Œæ–‡
ã¡ã‚Šã¤ã‚‚ã§ã™ã‚ˆ

# ã‚„ã£ãŸã“ã¨

zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ã¨ã‚µãƒ¼ãƒå´ã§å‹•ã„ã¦ã„ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå‡ºã¦ãã¾ã—ãŸï¼

```py
from Crypto.Util.number import bytes_to_long

with open("flag.txt", "rb") as f:
    flag = f.read()
flag = bytes_to_long(flag)

assert flag <= 10 ** 103

upper_bound = 300
while True:
    try:
        mod = int(input("Mod > "))
        if mod > upper_bound:
            print("Don't cheat ğŸ¤ª")
            continue

        result = flag % mod
        print(result)
    except Exception:
        print("Bye ğŸ‘‹")
        break
```

ãƒ•ãƒ©ã‚°ã‚’æ•°å€¤ã«å¤‰æ›ã—ãŸã‚‚ã®ã‚’ï¼Œ
ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®å…¥åŠ›å€¤ã§å‰²ã£ãŸä½™ã‚Šã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã§ã™ï¼
ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰å…¥åŠ›ã§ãã‚‹å€¤ã®ä¸Šé™ã¯300ã§ã™ï¼

å‡ºåŠ›çµæœã§ã‚ã‚‹ä½™ã‚Šã®å€¤ã‚’é›†ã‚ã¦ãƒ•ãƒ©ã‚°ã®æ•°å€¤ã‚’æ¨æ¸¬ã™ã‚‹å•é¡Œã‹ãªã¨æ€ã„ã¾ã—ãŸãŒï¼Œ
æ•°å­¦ã‚ˆã‚ã‚ˆã‚å‹¢ãªã®ã§è§£ã‘ã¾ã›ã‚“ã§ã—ãŸï¼æ‚²ã—ã¿ï¼

æ™‚é–“ã‚’ç½®ã„ã¦ã‹ã‚‰å†æŒ‘æˆ¦ã—ã‚ˆã†ã¨å•é¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¦‹ç›´ã—ãŸã¨ã“ã‚ï¼Œ
ãƒ¦ãƒ¼ã‚¶ã®å…¥åŠ›ã®ä¸‹é™å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ã“ã¨ã«æ°—ãŒã¤ãã¾ã—ãŸï¼

è©¦ã—ã«è² ã®å€¤ã‚’å…¥åŠ›ã™ã‚‹ã¨ï¼Œå¯¾å¿œã™ã‚‹çµæœãŒå¸°ã£ã¦ãã¾ã—ãŸï¼
```
nc crt.cry.wanictf.org 50000
Mod > -1
0
Mod > -2
0
Mod > -3
-1
```

è² ã®æ•°ã§ã®å‰°ä½™ã«ã¤ã„ã¦å°‘ã—èª¿æŸ»
```py
>>> 123 % -1000000
-999877
>>> 1000000 - 999877
123
```
ãŸã—ã‹ã«å¤§ããªè² ã®æ•°ã§å‰°ä½™ã—ãŸçµæœã‹ã‚‰å…ƒã®å€¤ã‚’å¾©å…ƒã§ããˆã‚‹ã“ã¨ãŒç¢ºã‹ã‚ã‚‰ã‚Œã¾ã—ãŸ
ã“ã‚Œã‚’ä½¿ã£ã¦ãƒ•ãƒ©ã‚°ã®å€¤ã‚’ã¨ã£ã¦ã¿ã¾ã™ï¼

```
nc crt.cry.wanictf.org 50000
Mod > -1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-999999999999999999990159419553623771292182053863936378683792187168026886550747783166620982570144103000771436923911878705910
```

```
python 
>>> 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 - 999999999999999999990159419553623771292182053863936378683792187168026886550747783166620982570144103000771436923911878705910
9840580446376228707817946136063621316207812831973113449252216833379017429855896999228563076088121294090
```

ã“ã‚Œã§ãƒ•ãƒ©ã‚°å…¨ä½“ã®æ•°å€¤ãŒæ‰‹ã«å…¥ã‚Šã¾ã—ãŸï¼
ã“ã®æ•°å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¦ã¿ã¾ã™ï¼

```python
a = 9840580446376228707817946136063621316207812831973113449252216833379017429855896999228563076088121294090
print(a)
h = hex(a)[2:]
print(h)

flag = ''
for i in range(0, len(h), 2):
    flag += chr(int(h[i:i+2], 16))

print(flag)
```

```
$ python solver.py 
9840580446376228707817946136063621316207812831973113449252216833379017429855896999228563076088121294090
464c41477b4368316e3373335f72336d40316e6433725f3768333072336d5f5f736f5f75356566756c7d0a
FLAG{Ch1n3s3_r3m@1nd3r_7h30r3m__so_u5eful}
```
ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼

# ãƒ•ãƒ©ã‚°
FLAG{Ch1n3s3_r3m@1nd3r_7h30r3m__so_u5eful}
